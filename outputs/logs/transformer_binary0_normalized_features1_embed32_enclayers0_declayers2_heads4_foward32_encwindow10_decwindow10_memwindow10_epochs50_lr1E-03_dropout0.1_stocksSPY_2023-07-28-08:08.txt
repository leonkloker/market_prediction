Using cuda
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
Transformer                                        [1, 100, 1]               --
├─Linear: 1-1                                      [1, 100, 32]              64
├─Time2Vec: 1-2                                    [1, 100, 36]              --
│    └─Linear: 2-1                                 [100, 4]                  8
├─Linear: 1-3                                      [1, 100, 32]              (recursive)
├─Time2Vec: 1-4                                    [1, 100, 36]              (recursive)
│    └─Linear: 2-2                                 [100, 4]                  (recursive)
├─Transformer: 1-5                                 [1, 100, 36]              --
│    └─MyIdentity: 2-3                             [1, 100, 36]              --
│    └─TransformerDecoder: 2-4                     [1, 100, 36]              --
│    │    └─ModuleList: 3-1                        --                        26,488
│    │    └─LayerNorm: 3-2                         [1, 100, 36]              72
├─Sequential: 1-6                                  [1, 100, 1]               --
│    └─Linear: 2-5                                 [1, 100, 18]              666
│    └─Dropout: 2-6                                [1, 100, 18]              --
│    └─ReLU: 2-7                                   [1, 100, 18]              --
│    └─Linear: 2-8                                 [1, 100, 1]               19
├─Identity: 1-7                                    [1, 100, 1]               --
====================================================================================================
Total params: 27,317
Trainable params: 27,317
Non-trainable params: 0
Total mult-adds (M): 0.01
====================================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.38
Params size (MB): 0.02
Estimated Total Size (MB): 0.41
====================================================================================================
Epoch 1 / 50, train loss: 0.4991219937801361
Epoch 1 / 50, val loss: 7.461181640625
Epoch 1 / 50, val acc: 0.4725848563968668
Epoch 2 / 50, train loss: 0.44221606850624084
Epoch 2 / 50, val loss: 6.6980743408203125
Epoch 2 / 50, val acc: 0.4960835509138381
Epoch 3 / 50, train loss: 0.425919771194458
Epoch 3 / 50, val loss: 6.187551021575928
Epoch 3 / 50, val acc: 0.4804177545691906
Epoch 4 / 50, train loss: 0.4365535378456116
Epoch 4 / 50, val loss: 5.989710807800293
Epoch 4 / 50, val acc: 0.4856396866840731
Epoch 5 / 50, train loss: 0.44257572293281555
Epoch 5 / 50, val loss: 6.012843132019043
Epoch 5 / 50, val acc: 0.4934725848563969
Epoch 6 / 50, train loss: 0.43579307198524475
Epoch 6 / 50, val loss: 6.169437408447266
Epoch 6 / 50, val acc: 0.5039164490861618
Epoch 7 / 50, train loss: 0.4260188341140747
Epoch 7 / 50, val loss: 6.3985490798950195
Epoch 7 / 50, val acc: 0.5169712793733682
Epoch 8 / 50, train loss: 0.41584694385528564
Epoch 8 / 50, val loss: 6.650608062744141
Epoch 8 / 50, val acc: 0.5195822454308094
Epoch 9 / 50, train loss: 0.41263195872306824
Epoch 9 / 50, val loss: 6.826922416687012
Epoch 9 / 50, val acc: 0.45691906005221933
Epoch 10 / 50, train loss: 0.41064342856407166
Epoch 10 / 50, val loss: 6.9676971435546875
Epoch 10 / 50, val acc: 0.4908616187989556
Epoch 11 / 50, train loss: 0.41362664103507996
Epoch 11 / 50, val loss: 7.062976837158203
Epoch 11 / 50, val acc: 0.5195822454308094
Epoch 12 / 50, train loss: 0.4120366871356964
Epoch 12 / 50, val loss: 7.096377372741699
Epoch 12 / 50, val acc: 0.5195822454308094
Epoch 13 / 50, train loss: 0.4167477786540985
Epoch 13 / 50, val loss: 7.070178985595703
Epoch 13 / 50, val acc: 0.5326370757180157
Epoch 14 / 50, train loss: 0.4081355929374695
Epoch 14 / 50, val loss: 6.997653961181641
Epoch 14 / 50, val acc: 0.5195822454308094
Epoch 15 / 50, train loss: 0.40728840231895447
Epoch 15 / 50, val loss: 6.891227722167969
Epoch 15 / 50, val acc: 0.5039164490861618
Epoch 16 / 50, train loss: 0.4026276171207428
Epoch 16 / 50, val loss: 6.829277038574219
Epoch 16 / 50, val acc: 0.4856396866840731
Epoch 17 / 50, train loss: 0.4045679569244385
Epoch 17 / 50, val loss: 6.762726783752441
Epoch 17 / 50, val acc: 0.5065274151436031
Epoch 18 / 50, train loss: 0.40069180727005005
Epoch 18 / 50, val loss: 6.696314811706543
Epoch 18 / 50, val acc: 0.4751958224543081
Epoch 19 / 50, train loss: 0.40435877442359924
Epoch 19 / 50, val loss: 6.631986618041992
Epoch 19 / 50, val acc: 0.45430809399477806
Epoch 20 / 50, train loss: 0.4016658365726471
Epoch 20 / 50, val loss: 6.574989318847656
Epoch 20 / 50, val acc: 0.5013054830287206
Epoch 21 / 50, train loss: 0.4023423492908478
Epoch 21 / 50, val loss: 6.526710510253906
Epoch 21 / 50, val acc: 0.5065274151436031
Epoch 22 / 50, train loss: 0.4011629819869995
Epoch 22 / 50, val loss: 6.490583419799805
Epoch 22 / 50, val acc: 0.4725848563968668
Epoch 23 / 50, train loss: 0.4017816185951233
Epoch 23 / 50, val loss: 6.467123031616211
Epoch 23 / 50, val acc: 0.5117493472584856
Epoch 24 / 50, train loss: 0.40374693274497986
Epoch 24 / 50, val loss: 6.455084800720215
Epoch 24 / 50, val acc: 0.5509138381201044
Epoch 25 / 50, train loss: 0.40210407972335815
Epoch 25 / 50, val loss: 6.45460319519043
Epoch 25 / 50, val acc: 0.5378590078328982
Epoch 26 / 50, train loss: 0.40083879232406616
Epoch 26 / 50, val loss: 6.463435173034668
Epoch 26 / 50, val acc: 0.5274151436031331
Epoch 27 / 50, train loss: 0.39833927154541016
Epoch 27 / 50, val loss: 6.472310543060303
Epoch 27 / 50, val acc: 0.4908616187989556
Epoch 28 / 50, train loss: 0.39797288179397583
Epoch 28 / 50, val loss: 6.485020637512207
Epoch 28 / 50, val acc: 0.48825065274151436
Epoch 29 / 50, train loss: 0.39869099855422974
Epoch 29 / 50, val loss: 6.500497817993164
Epoch 29 / 50, val acc: 0.5039164490861618
Epoch 30 / 50, train loss: 0.3970562815666199
Epoch 30 / 50, val loss: 6.517783164978027
Epoch 30 / 50, val acc: 0.48825065274151436
Epoch 31 / 50, train loss: 0.39567601680755615
Epoch 31 / 50, val loss: 6.536134243011475
Epoch 31 / 50, val acc: 0.4856396866840731
Epoch 32 / 50, train loss: 0.3986299932003021
Epoch 32 / 50, val loss: 6.555363655090332
Epoch 32 / 50, val acc: 0.4856396866840731
Epoch 33 / 50, train loss: 0.39645710587501526
Epoch 33 / 50, val loss: 6.574619293212891
Epoch 33 / 50, val acc: 0.5065274151436031
Epoch 34 / 50, train loss: 0.4000387489795685
Epoch 34 / 50, val loss: 6.592391490936279
Epoch 34 / 50, val acc: 0.5039164490861618
Epoch 35 / 50, train loss: 0.39871543645858765
Epoch 35 / 50, val loss: 6.6084747314453125
Epoch 35 / 50, val acc: 0.5378590078328982
Epoch 36 / 50, train loss: 0.3953263759613037
Epoch 36 / 50, val loss: 6.626006126403809
Epoch 36 / 50, val acc: 0.5326370757180157
Epoch 37 / 50, train loss: 0.39779382944107056
Epoch 37 / 50, val loss: 6.640478134155273
Epoch 37 / 50, val acc: 0.5430809399477807
Epoch 38 / 50, train loss: 0.3944772183895111
Epoch 38 / 50, val loss: 6.646303176879883
Epoch 38 / 50, val acc: 0.5456919060052219
Epoch 39 / 50, train loss: 0.3966606855392456
Epoch 39 / 50, val loss: 6.650726318359375
Epoch 39 / 50, val acc: 0.5300261096605744
Epoch 40 / 50, train loss: 0.3965930640697479
Epoch 40 / 50, val loss: 6.653450012207031
Epoch 40 / 50, val acc: 0.5221932114882507
Epoch 41 / 50, train loss: 0.39645594358444214
Epoch 41 / 50, val loss: 6.654604911804199
Epoch 41 / 50, val acc: 0.5404699738903395
Epoch 42 / 50, train loss: 0.3946576714515686
Epoch 42 / 50, val loss: 6.655073165893555
Epoch 42 / 50, val acc: 0.5300261096605744
Epoch 43 / 50, train loss: 0.39427345991134644
Epoch 43 / 50, val loss: 6.65524435043335
Epoch 43 / 50, val acc: 0.5248041775456919
Epoch 44 / 50, train loss: 0.3974195420742035
Epoch 44 / 50, val loss: 6.65399169921875
Epoch 44 / 50, val acc: 0.5169712793733682
Epoch 45 / 50, train loss: 0.39761418104171753
Epoch 45 / 50, val loss: 6.651180267333984
Epoch 45 / 50, val acc: 0.5274151436031331
Epoch 46 / 50, train loss: 0.3957602381706238
Epoch 46 / 50, val loss: 6.647447109222412
Epoch 46 / 50, val acc: 0.5404699738903395
Epoch 47 / 50, train loss: 0.39589202404022217
Epoch 47 / 50, val loss: 6.643032073974609
Epoch 47 / 50, val acc: 0.5404699738903395
Epoch 48 / 50, train loss: 0.39662283658981323
Epoch 48 / 50, val loss: 6.638009548187256
Epoch 48 / 50, val acc: 0.5352480417754569
Epoch 49 / 50, train loss: 0.3973096013069153
Epoch 49 / 50, val loss: 6.6352081298828125
Epoch 49 / 50, val acc: 0.5404699738903395
Epoch 50 / 50, train loss: 0.3975810110569
Epoch 50 / 50, val loss: 6.632205963134766
Epoch 50 / 50, val acc: 0.5430809399477807
Training finished

Evaluating best model on test set
Trading strategy for stock SPY:
After 384 trading days
Binary accuracy: 0.51958
Fraction of long signals: 0.51302
Fraction of short signals: 0.48698
Overall long return: 0.03127
Overall return: 0.01706
Yearly long return: 0.02052
Yearly return: 0.01120
Daily volatility: 0.01338
Max drawdown baseline: 0.23197
Max drawdown: 0.26829
Sharpe ratio: -0.00276
L1 error baseline: 2.45427
L1 error: 2.56245
Average prediction: -0.10818
Std prediction: 0.00011
